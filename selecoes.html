
<!doctype html><html lang="pt-BR"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Selecoes ‚Äî Dashboard Copas</title><script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
<style>:root{--bg:#0b1220;--card:#0f1724;--accent:#1f6feb;--muted:#94a3b8}body{margin:0;font-family:Inter,Segoe UI,Helvetica,Arial;background:var(--bg);color:#e6eef8}header{background:linear-gradient(90deg, rgba(31,111,235,0.12), rgba(20,20,30,0.04));padding:14px 18px;border-bottom:1px solid rgba(255,255,255,0.03)}.container{max-width:1200px;margin:14px auto;padding:0 16px}.nav{display:flex;gap:12px;align-items:center}.nav a{color:#cfe1ff;text-decoration:none;padding:8px 12px;border-radius:8px}.nav a:hover{background:rgba(255,255,255,0.02);color:white}.title{font-size:18px;font-weight:700;margin-right:12px;color:white}.card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.6);min-width:140px}.kpi{font-size:18px;font-weight:700;color:#fff}.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.full{grid-column:1/-1}.table-wrap{max-height:360px;overflow:auto;background:var(--card);padding:8px;border-radius:8px}.small{font-size:12px;color:var(--muted)}@media(max-width:900px){.grid{grid-template-columns:1fr}}</style></head><body>
<header><div class="container nav"><div class="title">Dashboard ‚Äî Copas do Mundo</div><nav style="display:flex;gap:6px"><a href="index.html">üè† In√≠cio</a><a href="selecoes.html">üáßüá∑ Sele√ß√µes</a><a href="estadios.html">üèüÔ∏è Est√°dios</a><a href="gols.html">‚öΩ Gols</a><a href="recordes.html">‚≠ê Recordes</a><a href="analises.html">An√°lises Especiais</a></nav></div></header>

<main class="container"><div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
  <div><h2 style="margin:4px 0;color:white">An√°lises por Sele√ß√£o</h2><div class="small">Escolha uma sele√ß√£o para ver desempenho e maior goleada</div></div>
  <div style="display:flex;gap:8px;align-items:center"><div class="card"><label class="small">Sele√ß√£o</label><br><select id="sel-team-filter"></select></div></div>
</div>
<div class="grid" style="margin-top:12px">
  <div class="card full" id="chart-team-topwins" style="min-height:360px"></div>
	  <div class="card full" id="chart-team-heatmap" style="min-height:360px"></div>
  <div class="card" style="min-height:220px"><h3 style="margin-top:0;color:white">Maior goleada da sele√ß√£o</h3><div id="maior-goleada-team" class="kpi">‚Äì</div></div>
  <div class="card">
  <h3>Maior goleada sofrida</h3>
  <div id="suffered" class="kpi">‚Äì</div>
</div>
  <div class="card" style="min-height:220px" id="team-stats"></div>
  <div class="card full table-wrap" id="table-selecao"></div>
</div></main>
<footer style="color:var(--muted);text-align:center;padding:18px 0">Gerado automaticamente ¬∑ Dados embutidos ¬∑ Teste local ou GitHub Pages</footer>


<script src="dados.js"></script>
<script>
</script>

<script>
const teams = unique(DATA.flatMap(d=>[d["Time A"], d["Time B"]]));
const sel = document.getElementById('sel-team-filter');
const optAll = document.createElement('option'); optAll.value='all'; optAll.text='Todas'; sel.appendChild(optAll);
teams.forEach(t=>{ const o=document.createElement('option'); o.value=t; o.text=t; sel.appendChild(o); });
sel.addEventListener('change', ()=>{ renderTeamPage(); });
function plotTopWins(filtered){ const wins={}; filtered.forEach(r=>{ const a=r["Time A"], b=r["Time B"]; const pa=Number(r["Placar A"]||0), pb=Number(r["Placar B"]||0); if(pa>pb) wins[a]=(wins[a]||0)+1; else if(pb>pa) wins[b]=(wins[b]||0)+1; }); const arr=Object.entries(wins).map(([k,v])=>({team:k,wins:v})).sort((a,b)=>b.wins-a.wins).slice(0,12); Plotly.newPlot('chart-team-topwins',[{x:arr.map(a=>a.team),y:arr.map(a=>a.wins),type:'bar'}],{title:{text:'Top sele√ß√µes por vit√≥rias (filtradas)'},paper_bgcolor:'rgba(0,0,0,0)',plot_bgcolor:'rgba(0,0,0,0)',font:{color:'#e6eef8'}}); }
function maiorGoleadaDoTime(team) {
  if (!team || team === 'all') {
    document.getElementById('maior-goleada-team').innerText = 'Selecione uma sele√ß√£o';
    return;
  }

  const jogos = DATA.filter(r => r["Time A"] === team || r["Time B"] === team);
  let best = null;
  let diff = 0;

  jogos.forEach(r => {
    const pa = Number(r["Placar A"] || 0);
    const pb = Number(r["Placar B"] || 0);
    const a = r["Time A"];
    const b = r["Time B"];

    // calcula diferen√ßa apenas se o time venceu
    if (a === team && pa > pb) {
      const d = pa - pb;
      if (d > diff) { diff = d; best = r; }
    } else if (b === team && pb > pa) {
      const d = pb - pa;
      if (d > diff) { diff = d; best = r; }
    }
  });

  const el = document.getElementById('maior-goleada-team');
  if (best)
    el.innerText = `${best["Time A"]} ${best["Placar A"]} √ó ${best["Placar B"]} ${best["Time B"]} ‚Äî ${best["Ano"]}`;
  else
    el.innerText = 'Nenhuma vit√≥ria encontrada';
}

function teamStats(team){ if(!team || team==='all'){ document.getElementById('team-stats').innerHTML='<div class="small">Escolha uma sele√ß√£o para estat√≠sticas</div>'; return; } let games=0,wins=0,draws=0,losses=0,forg=0,against=0; DATA.forEach(r=>{ const a=r["Time A"], b=r["Time B"]; const pa=Number(r["Placar A"]||0), pb=Number(r["Placar B"]||0); if(a===team || b===team){ games++; const gf = (a===team)?pa:pb; const ga=(a===team)?pb:pa; forg+=gf; against+=ga; if(gf>ga) wins++; else if(gf===ga) draws++; else losses++; } }); document.getElementById('team-stats').innerHTML = `<div class="small">Jogos: ${games}</div><div class="small">Vit√≥rias: ${wins} ‚Äî Empates: ${draws} ‚Äî Derrotas: ${losses}</div><div class="small">Gols: ${forg} marcados ¬∑ ${against} sofridos</div>`; const table = DATA.filter(r=> r["Time A"]===team || r["Time B"]===team ).slice(0,200); let html = '<table style="width:100%;border-collapse:collapse;color:#dbeafe"><thead><tr><th>Ano</th><th>Time A</th><th>Placar</th><th>Time B</th><th>Estadio</th></tr></thead><tbody>'; table.forEach(r=> html += `<tr><td class="small">${r["Ano"]}</td><td class="small">${r["Time A"]}</td><td class="small">${r["Placar A"]} x ${r["Placar B"]}</td><td class="small">${r["Time B"]}</td><td class="small">${r["Estadio"]}</td></tr>`); html += '</tbody></table>'; document.getElementById('table-selecao').innerHTML = html; }
function plotTeamHeatmap(team) {
  if (!team || team === 'all') {
    Plotly.purge('chart-team-heatmap');
    return;
  }

  const years = unique(DATA.map(d => d["Ano"])).sort((a, b) => a - b);
  const phases = ["Primeira Fase", "Fase de Grupos", "Segunda Fase", "Oitavas-de-final", "Quartas-de-final", "Semifinais", "Decisao do Terceiro Lugar", "Final"];
  const z = [];

  years.forEach(year => {
    const row = [];
    phases.forEach(phase => {
      const match = DATA.find(r => r["Ano"] === year && r["Fase"] === phase && (r["Time A"] === team || r["Time B"] === team));
      let value = 0; // 0: N√£o jogou, 1: Derrota, 2: Empate, 3: Vit√≥ria

      if (match) {
        const pa = Number(match["Placar A"] || 0);
        const pb = Number(match["Placar B"] || 0);
        const isTeamA = match["Time A"] === team;

        if (pa === pb) {
          value = 2; // Empate
        } else if ((isTeamA && pa > pb) || (!isTeamA && pb > pa)) {
          value = 3; // Vit√≥ria
        } else {
          value = 1; // Derrota
        }
      }
      row.push(value);
    });
    z.push(row);
  });

  const data = [{
    z: z,
    x: phases,
    y: years,
    type: 'heatmap',
    colorscale: [
      [0, 'rgb(30, 30, 30)'], // N√£o jogou
      [0.33, 'rgb(165, 0, 38)'], // Derrota
      [0.66, 'rgb(255, 255, 191)'], // Empate
      [1, 'rgb(0, 104, 71)'] // Vit√≥ria
    ],
    hoverongaps: false,
    showscale: false
  }];

  const layout = {
    title: { text: `Desempenho de ${team} por Fase e Edi√ß√£o` },
    paper_bgcolor: 'rgba(0,0,0,0)',
    plot_bgcolor: 'rgba(0,0,0,0)',
    font: { color: '#e6eef8' },
    xaxis: { title: 'Fase', tickangle: -45 },
    yaxis: { title: 'Ano' }
  };

  Plotly.newPlot('chart-team-heatmap', data, layout);
}

function maiorGoleadaSofrida(team) {
  if (!team || team === 'all') {
    const el = document.getElementById('suffered');
    if(el) el.innerText = 'Selecione uma sele√ß√£o';
    return;
  }

  // partidas onde a sele√ß√£o participou e perdeu
  const perdas = DATA.filter(r => {
    const pa = Number(r["Placar A"]||0), pb = Number(r["Placar B"]||0);
    if (r["Time A"] === team && pa < pb) return true;
    if (r["Time B"] === team && pb < pa) return true;
    return false;
  });

  if (perdas.length === 0) {
    const el = document.getElementById('suffered');
    if(el) el.innerText = 'Nenhuma derrota encontrada';
    return;
  }

  // escolher a maior derrota pela diferen√ßa de gols
  let best = null;
  let maxDiff = -1;
  perdas.forEach(r => {
    const pa = Number(r["Placar A"]||0), pb = Number(r["Placar B"]||0);
    let diff = 0;
    if (r["Time A"] === team) diff = pb - pa;
    else diff = pa - pb;
    if (diff > maxDiff) { maxDiff = diff; best = r; }
  });

  const el = document.getElementById('suffered');
  if (!el) return;
  if (best) {
    const pa = Number(best["Placar A"]||0), pb = Number(best["Placar B"]||0);
    const winner = pa > pb ? best["Time A"] : best["Time B"];
    const winnerScore = Math.max(pa, pb);
    const loser = pa > pb ? best["Time B"] : best["Time A"];
    const loserScore = Math.min(pa, pb);
    el.innerText = `${winner} ${winnerScore} √ó ${loserScore} ${loser} ‚Äî ${best["Ano"]}`;
  } else {
    el.innerText = 'Nenhuma derrota encontrada';
  }
}

function renderTeamPage(){ 
  const team = sel.value; 
  plotTopWins(DATA); 
  maiorGoleadaDoTime(team); 
  teamStats(team); 
  maiorGoleadaSofrida(team);
  plotTeamHeatmap(team);
} 
plotTopWins(DATA);
</script>
</body></html>
